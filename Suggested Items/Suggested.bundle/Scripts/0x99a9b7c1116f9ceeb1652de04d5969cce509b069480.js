"use strict"; class PU{constructor(){}sP(r,s,a){r[s]=a[0],r[s+1]=a[1],r[s+2]=a[2],r[s+3]=a[3]}ease(r,s,a=.1){return a>0?ro(r+(s-r)*a):ro(r-(s-r)*Math.abs(a))}} class Itbl{constructor(){this.config={},this.its=[],this.sImg=[]}setup(){return new pR(async r=>{this.its=[],this.its=await this.layout();for(var i=5,t=cW,a=cH,s=0,l=0,h=0;h<this.its.length;h++){var R=this.its[h];0==gLD(R.W)&&(R.W-=1),0==gLD(R.H)&&(R.H-=1),R.W<2&&(R.W=2),R.H<2&&(R.H=2),R.dColor=i,R.x+R.W>s&&(s=R.x+R.W),R.y+R.H>l&&(l=R.y+R.H),R.x<t&&(t=R.x),R.y<a&&(a=R.y),i+=5}var o=cW/2-(s-t)/2,e=cH/2-(l-a)/2,F=ro(o-t),c=ro(e-a);for(h=0;h<this.its.length;h++)this.its[h].x+=F,this.its[h].y+=c;await this.set(),r()})}async set(){return new pR(async r=>{iGFX.strokeStyle="none",iGFX.fillStyle="rgb(255,255,255)",iGFX.fillRect(0,0,cW,cH),await this.fda();var i,t,a,s,l,h=iGFX.getImageData(0,0,cW,cH),o=h.data,e=!1;1==cT?(i=R.ri(4,6),s=1,l=R.ri(1,2),t=R.ri(4,6),a=R.ri(2,8)):2==cT?(i=R.ri(2,6),s=R.ri(1,2),l=R.ri(1,2),t=R.ri(1,2),a=R.ri(2,8),e=!0):3==cT?(i=R.ri(1,2),s=R.ri(1,2),l=R.ri(1,2),t=R.ri(1,2),a=R.ri(2,8),e=!0):4==cT?(i=R.ri(4,6),s=R.ri(1,2),l=1,t=R.ri(4,6),a=R.ri(2,8)):(i=R.ri(2,6),s=R.ri(1,2),l=R.ri(1,2),t=R.ri(2,4),a=R.ri(2,8));for(var F=[],c=[],x=0,y=0;y<1e5;y++){(n={xSkew:whD(R.ri(-a,a)).w,ySkew:whD(0,R.ri(-a,a)).h,edn:y}).sx=ro(Math.sin(n.xSkew*n.edn)*s),n.sy=ro(Math.cos(n.ySkew*n.edn)*l),c.push(n)}for(y=0;y<this.its.length;y++)for(var n=this.its[y],f=0;f<i;f++)for(var u=0;u<t;u++)F.push(new pR(r=>{for(var i=n.y;i<=n.y+n.H;i++)for(var t=n.x;t<=n.x+n.W;t++){var a=c[x].sy,s=e?2:c[x].sx;++x>=1e5&&(x=0);var l=4*(i*cW+t),h=4*((i+s)*cW+(t+a)),R=o[l],F=o[l+1],y=o[l+2],f=o[l+3];pUtil.sP(o,h,[R,F,y,f])}r()}));await pR.all(F),iGFX.putImageData(h,0,0),r()})}fda(){iGFX.fillStyle="rgba(255,255,255,255)";for(var r=0;r<this.its.length;r++)for(var i=this.its[r],t=0;t<200;t++){var a=R.ri(-i.W/3,i.W/3),s=R.ri(-i.H/3,i.H/3),l=R.ri(-12,12),h=R.rc(aClrs),o=rD(bgAl/255,2),e=rD((bgAl-50)/255,2);cSel>.9&&(o=1,e=1);var F=R.ri(i.W/20,i.W),c=R.ri(i.H/20,i.H),x=i.x+a,y=i.y+s;4==cT||5==cT?(iGFX.fillStyle="rgba("+h[0]+","+h[1]+","+h[2]+","+e+")",iGFX.fillRect(x+(R.rb()?1:-1)*l,y+(R.rb()?1:-1)*l,F,c),iGFX.fillStyle="rgba("+h[0]+","+h[1]+","+h[2]+","+o+")",iGFX.fillRect(x,y,F,c)):t%4==0?(iGFX.fillStyle="rgba("+h[0]+","+h[1]+","+h[2]+","+e+")",iGFX.beginPath(),iGFX.arc(x+(R.rb()?1:-1)*l,y+(R.rb()?1:-1)*l,F,0,2*Math.PI),iGFX.fill(),iGFX.fillStyle="rgba("+h[0]+","+h[1]+","+h[2]+","+o+")",iGFX.beginPath(),iGFX.arc(x,y,F,0,2*Math.PI),iGFX.fill()):(iGFX.fillStyle="rgba("+h[0]+","+h[1]+","+h[2]+","+e+")",iGFX.fillRect(x+(R.rb()?1:-1)*l,y+(R.rb()?1:-1)*l,F,c))}}layout(){return new pR((r,i)=>{var t=this.cellsX=16,a=this.cellsY=16,s=[];this.lMX=ro(cW/16),this.lMY=ro(cH/16);var l=ro(this.lMX/4),h=ro(this.lMY/4),R=ro(cW-2*this.lMX-t*l-2*l),o=ro(cH-2*this.lMY-a*h-2*h),e=ro(R/t),F=ro(o/a),c=isLand?F:e;this.guide=[];for(var x=1;x<t;x++)for(var y=1;y<a;y++)this.guide.push({x:this.lMX+x*e+x*l,y:this.lMY+y*F+y*h,w:e,h:F});this.bC=[],this.LTS=[{order:1,type:"XSMALL",W:2,H:2,RS:36,max:24,CT:0,maxFPx:8,cFpx:0,R:{xPF:2.5,yPF:2.5,iPF:1,wF:3,wS:aRlt?-1:-.5,hF:3,mF:6}},{order:2,type:"SMALL",W:4,H:4,RS:16,max:12,maxFPx:4,CT:0,cFpx:0,R:{xPF:1.5,yPF:1.5,iPF:1,wF:2,wS:0,hF:2,mF:4}},{order:3,type:"MEDIUM",W:6,H:6,RS:4,max:4,CT:0,maxFPx:2,cFpx:0,R:{xPF:2,yPF:2,iPF:2,wF:1,wS:aRlt?-1:0,hF:1,mF:2}},{order:4,type:"LARGE",W:8,H:8,RS:3,max:2,CT:0,maxFPx:2,dimAdjust:!0,cFpx:0,R:{xPF:.5,yPF:.5,iPF:1.5,wF:.5,wS:2,hF:1.5,mF:1}},{order:5,type:"XLARGE",W:10,H:10,RS:2,max:1,CT:0,maxFPx:1,cFpx:0,R:{xPF:1.5,yPF:1,iPF:3,wF:1,wS:0,hF:.5,mF:-1}}],"axonic"==layout?s=this.axonic(c):"somatic"==layout?s=this.somatic(rL,c,l,t):"dendritic"==layout&&(s=this.dendritic(t,a,e,F,c,l,h)),s.length<=1&&(s=this.axonic(c)),r(s)})}axonic(r){ofSd=0;var i=[];isL=!1,layout="axonic";var t={W:14*r,H:14*r};return t.x=ro(cW/2-t.W/2),t.y=ro(cH/2-t.H/2),t.LT=this.LTS[4],nC=1,i.push(t),i}somatic(r,i,t){var a,s,l=[],h=this.LTS[r];nC=h.RS;for(var R=0;R<h.RS;R++){var o=i*(h.W-h.R.wS);h.dimAdjust&&(o*(h.RS/h.R.mF)>cW&&(o=(cW-t*(h.RS-1)-2*this.lMX)/(h.RS/h.R.mF)),o*(h.RS/h.R.mF)>cH&&(o=(cH-t*(h.RS-1)-2*this.lMY)/(h.RS/h.R.mF))),0==R&&(a=cW/2-o*h.R.wF-t*h.R.xPF,s=cH/2-o*h.R.hF-t*h.R.yPF);var e={W:o,H:o,x:ro(a),y:ro(s),LT:this.LTS[4]};l.push(e),a+=o+t*h.R.iPF,h.R.mF>-1&&(R+1)%h.R.mF==0&&(a=cW/2-o*h.R.wF-t*h.R.xPF,s+=o+t)}return l}dendritic(r,i,t,a,s,l,h){for(var o=[],e=[],F=[],c=0;c<nC;c++){var x=R.rc(this.LTS);F.push({layout:x})}for(c=0;c<F.length;c++){var y=F[c],n=this.LTS.indexOf(y.layout),f=this.LTS[n];f.CT>=f.max&&n>0&&(y.layout=this.LTS[n-1],c--),f.CT++}for(nC>4&&this.aBC(r,i,2,4,1,2,t,a,l,h),F=F.sort(function(r,i){return i.layout.order-r.layout.order}),c=0;c<F.length;c++){for(var u=F[c].layout,S=null,H=null,W=!1,v=0;(W||null==S||null==H)&&v<2e3;)S=R.ri(1,r-u.W),H=R.ri(1,i-u.H),W=this.cSH(S,H,r,i,u),v++;if(v>=2e3){S=null,H=null;for(var m=r-u.W;m>0;m--)for(var p=0;p<i-u.H;p++)if(!(W=this.cSH(m,p,r,i,this.bC,u))){S=m,H=p;break}if(S&&H)for(e.push({x:S,y:H,LT:u}),m=0;m<u.W;m++)for(p=0;p<u.H;p++)this.bC.push({x:S+m,y:H+p})}else if(S&&H)for(e.push({x:S,y:H,LT:u}),m=0;m<u.W;m++)for(p=0;p<u.H;p++)this.bC.push({x:S+m,y:H+p})}return e.forEach(r=>{var i={x:ro(this.lMX+r.x*(t+l)),y:ro(this.lMY+r.y*(a+h)),W:ro(s*r.LT.W),H:ro(s*r.LT.H),LT:r.LT};o.push(i)}),o}aBC(r,i,t,a,s,l,h,o,e,F){var c=R.rc(["HOR","VERT"]),x={W:"HOR"==c?R.ri(t,a):R.ri(s,l),H:"VERT"==c?R.ri(t,a):R.ri(s,l)};x.xCell=R.ri(4,r-x.W-2),x.yCell=R.ri(4,i-x.H-2),x.x=ro(this.lMX+x.xCell*(h+e)),x.y=ro(this.lMY+x.yCell*(o+F)),x.w=ro(x.W*h),x.h=ro(x.H*o),this.sImg.push(x);for(var y=0;y<x.W;y++)for(var n=0;n<x.H;n++)this.bC.push({x:x.xCell+y,y:x.yCell+n})}cSH(r,i,t,a,s){for(var l=!1,h=0;h<s.W;h++)for(var R=0;R<s.H;R++)this.bC.filter(t=>t.x==r+h&&t.y==i+R).length>0&&(l=!0),(r+h>t||i+R>a)&&(l=!0);return l}} class Axon{constructor(s){this.op=s,this.pathway=[],this.points=[],this.pIndex=0,this.started=!1,this.eFI=0,this.rIntI=0,this.aReady=!1,this.reps=0,this.cEF=12,this.mnLV=.1,this.cLV=this.mxLV=mLV,this.limGUp=!1,this.aware=isA,this.pIi=0,this.filR=this.op.fIC[0],this.filG=this.op.fIC[1],this.filB=this.op.fIC[2],this.xOff=this.op.w/12,this.yOff=this.op.w/12}snap(s,t,i){for(var h=[],a=ro(s.x),p=ro(s.y),e=a;e<a+t;e++)for(var o=p;o<p+i;o++){var r;const s=4*(o*iGFX.canvas.width+e);r={sX:e,sY:o,cX:e,cY:o,aT:0,aB:0,aL:0,aR:0,r:iGFXD[s],g:iGFXD[s+1],b:iGFXD[s+2]},h.push(r)}return h}async setup(){this.started||(this.started=!0,this.reprogram(isA),this.pathway=await this.fP(this.op.pos,this.op.pL),this.points=await this.snap(this.op.pos,this.op.w,this.op.h),this.pIndex=0,this.shiftMind())}shiftMind(){sT(()=>{this.canChange()&&!isC&&(this.reprogram(),this.reps++),this.shiftMind()},this.op.rInts[this.rIntI]+(this.aReady?0:this.op.rFreq)),this.rIntI++,this.rIntI==this.op.rInts.length&&(this.rIntI=0)}canChange(){var s=!1;return dTC||(sR||this.reps<sR?s=!0:dTC=!0),s}reprogram(s=null){this.aReady?(this.setA(s),this.aReady=!1):(this.op.eF[this.eFI].a&&(this.aReady=!0),this.aware&&!hA&&(this.setA(s),this.eFI>0&&this.eFI--)),this.op.eFX=this.op.eF[this.eFI].x/(this.aware?this.op.aEf:1),this.op.eFY=this.op.eF[this.eFI].y/(this.aware?this.op.aEf:1),this.eFI++,this.eFI==this.op.eF.length&&(this.eFI=0)}setA(s,t=!1){this.aware=s||!this.aware,0==t&&pM(ae,"a",this.aware),t&&(this.op.eFX=this.aware||isA?this.op.eFX/this.op.aEf:this.op.eFX*this.op.aEf,this.op.eFY=this.aware||isA?this.op.eFY/this.op.aEf:this.op.eFY*this.op.aEf)}uP(s,t){this.pIndex>=this.pathway.length&&(this.pIndex=0,this.op.noR&&(s.cX=s.sX,s.cY=s.sY));var i=this.pathway[this.pIndex];this.seek(s,i,t),this.pr(s);var h=this.aware?this.op.fEs:2*this.op.fEs;return this.pIndex++,h==s.aT&&(s.cY=this.fESd(s,"y"),s.aT=0),h==s.aB&&(s.cY=this.fESd(s,"y"),s.aB=0),h==s.aR&&(s.cX=this.fESd(s,"x"),s.aR=0),h==s.aL&&(s.cX=this.fESd(s,"x"),s.aL=0),s}fESd(s,t){var i;if(0==ofSd)i="x"==t?s.sX:s.sY;else if(1==ofSd){var h;i="x"==t?(h=s.cX-2*s.sX)>oW&&h<cW-oW?h:s.sX:(h=s.cY-2*s.sY)>oW&&h<cH-oW?h:s.sY}return i}seek(s,t,i){if(this.op.isL)var h=Math.abs(s.cX-t.x)>this.cLV,a=Math.abs(s.cY-t.y)>this.cLV;(!this.op.isL||this.op.adHA||(eithOr?h||a:h&&a)||isC||isFr)&&(this.aD=i?this.op.adHA:1,isC?(s.cX=pUtil.ease(s.cX,s.sX,this.eX/this.aD),s.cY=pUtil.ease(s.cY,s.sY,this.eY/this.aD)):(s.cX=pUtil.ease(s.cX,t.x+this.op.pCor*(s.cX-s.sX),this.eX/this.aD),s.cY=pUtil.ease(s.cY,t.y+this.op.pCor*(s.cY-s.sY),this.eY/this.aD)))}pr(s){s.cX<=oW&&(s.cX=oW,s.aL++),s.cX>=ccW-oW&&(s.cX=ccW-oW,s.aR++),s.cY<=oW&&(s.cY=oW,s.aT++),s.cY>=ccH-oW&&(s.cY=ccH-oW,s.aB++)}fire(){for(var s of(this.eX=this.op.eFX,this.eY=this.op.eFY,this.cLV<this.mnLV?this.limGUp=!0:this.cLV>this.mxLV&&(this.limGUp=!1),this.limGUp?this.cLV=this.cLV+this.op.limInc:this.cLV=this.cLV-this.op.limInc,isFr&&(this.eX=this.op.eFX*fEF,this.eY=this.op.eFY*fEF),isC&&(this.eX=this.op.eFX*this.cEF,this.eY=this.op.eFY*this.cEF),this.points)){var t=this.pS(s);s=this.uP(s,t)||s}}pS(s){var t=4*(s.cY*cW+s.cX),i=!1;return nvGFXD[t]==this.op.dColor?pUtil.sP(eGFXD,t,[s.r,s.g,s.b,255]):nvGFXD[t]>=5&&0==eGFXD[t]?(i=!0,pUtil.sP(eGFXD,t,[this.filR,this.filG,this.filB,220])):0==eGFXD[t+3]&&pUtil.sP(eGFXD,t,[s.r,s.g,s.b,255]),i}fP(s,t){for(var i,h,a=0,p=0,e=[],o=0;o<t;o++){var r=s;this.op.based&&o>0&&(r=e[o-1]),i=(r.x+s.x)/2+(Math.sin(o/this.op.pFx)*this.op.xF+(o*(this.op.hXm?1:0)+a)),h=(r.y+s.y)/2+(Math.cos(o/this.op.pFy)*this.op.yF+(o*(this.op.hXm?1:0)+p)),a+=this.op.bstX,p+=this.op.bstY,e.push({x:ro(i+this.xOff),y:ro(h+this.yOff)})}return e}} var dClr=[[231,97,70],[102,0,204],[32,110,187],[201,63,21],[187,27,7],[254,236,75],[149,206,172],[44,117,169],[0,0,255],[51,255,255]];const curat=[[[253,253,150],[255,182,193],[255,160,122],[255,105,97],[255,140,105]],[[135,206,250],[176,224,230],[240,248,255],[240,255,255],[135,206,235]],[[255,223,186],[255,239,213],[255,228,196],[255,222,173],[255,245,110]],[[166,208,166],[173,235,173],[210,248,210],[153,204,153],[177,224,198]],[[29,255,220],[81,134,236],[63,83,58],[195,214,146],[56,37,43]],[[25,227,206],[80,92,226],[114,104,21],[212,226,117],[88,46,67]]];var getAura=()=>{var r=cSel<=.03?[[250,250,250],[240,240,240],[230,230,230],[220,220,220],[210,210,210]]:cSel<=.06?[[250,250,250],[250,250,250],[230,230,230],[60,60,60],[20,20,20]]:cSel<=.075?[[255,255,255],[0,0,255]]:cSel<=.09?[[255,255,255],[255,0,0]]:cSel<=.105?[[255,255,255],[0,255,0]]:cSel<=.9?gRgbP():gCur(),e=0;for(fIC1=[255,255,255],fIC2=[255,255,255];fIC1[0]>220&&fIC1[1]>220&&fIC1[2]>120&&e<r.length;){var l=R.ri(0,r.length-1);fIC1=r[l],e++}for(e=0;fIC2[0]>220&&fIC2[1]>220&&fIC2[2]>120&&e<r.length;)l=R.ri(0,r.length-1),fIC2=r[l],e++;const C=((r,e,l)=>r.filter(r=>!e.some(e=>((r,e)=>r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2])(r,e))))(dClr,r);return odC=[...C],r},gRgbP=()=>{var r=R.ri(2,R.ri(3,6)),e=shuf(dClr).slice(0,r);return adW&&e.push([255,255,255]),e},gCur=()=>{var r=R.ri(0,curat.length-1);return shuf(curat[r])}; class CND{constructor(){this.pCS=[]}}CND.prototype.init=function(){for(var r=0,t=[],s=0;s<60;s++)t.push(R.ri(repInt||12e3,repInt||24e3));t[0]=ro(1.2*t[0]);for(var n=0;n<nC;n++){var a=R.rn(1,20),o={xF:rD(a,2),yF:rD(a*R.rn(1,4),2),pL:R.ri(50,maxPL),pFx:R.ri(1,50),pFy:R.ri(1,50),bstX:R.rb(bst)&&nC>1?rD(R.rn(-bstVal,bstVal),2):0,bstY:R.rb(bst)&&nC>1?rD(R.rn(-bstVal,bstVal),2):0,sH:R.rb(),fEs:R.ri(60,200),aEf:R.ri(3,6),hXm:1==nC||R.rb(xMF),noR:R.rb(.7)||1==nC,fIC:R.rb(.95)?R.rc(aClrs):R.rc(odC),sliced:!1,isL:isM&&R.rb()||isL,pCor:R.rb(pCor)?1:0,limInc:rD(R.rn(.005,.04),3),rInts:t,rFreq:r,adHA:R.ri(2,4)};o.fEs=whD(o.fEs,o.fEs,!0).b,r+=50,o.based=!!R.rb(bOLI);var i=[];for(s=0;s<100;s++){var p=s%(2+R.ri(-2,2))==0,e={x:rD(R.rb()||0==s||p?R.rn(-tSp,-.006):R.rn(.006,tSp),6),y:rD(R.rb()||0==s||p?R.rn(-tSp,-.006):R.rn(.006,tSp),6),a:p};i.push(e)}o.eF=i,this.pCS.push(o)}},CND.prototype.develop=function(){for(var r=0;r<mC.m.length;r++)mC.m[r].fire()},CND.prototype.setup=function(){iImgD=iGFX.getImageData(0,0,cW,cH),iGFXD=iImgD.data,this.startAxons()},CND.prototype.startAxons=async function(){for(var r=0;r<mC.a.its.length;r++){var t=this.pCS[r],s=mC.a.its[r];t.pos={x:s.x,y:s.y},t.id=r,t.w=s.W,t.h=s.H,t.dColor=s.dColor,t.LT=s.LT,R.rb(.87)&&(nvGFX.fillStyle="rgba("+t.dColor+",255,255,255)",nvGFX.fillRect(t.pos.x,t.pos.y,t.w,t.w)),nvGFXD=nvGFX.getImageData(0,0,cW,cH).data;var n=new Axon(t);await n.setup(),mC.m.push(n)}}; var rIP,sRP,sT=setTimeout,sI=setInterval,pF=parseFloat,pI=parseInt,doc=document,wi=window,pR=Promise;class Random{constructor(){this.useA=!1;let t=function(t){let e=pI(t.substr(0,8),16),s=pI(t.substr(8,8),16),r=pI(t.substr(16,8),16),n=pI(t.substr(24,8),16);return function(){let t=((e|=0)+(s|=0)|0)+(n|=0)|0;return n=n+1|0,e=s^s>>>9,s=(r|=0)+(r<<3)|0,r=(r=r<<21|r>>>11)+t|0,(t>>>0)/4294967296}};this.prngA=new t(tokenData.hash.substr(2,32)),this.prngB=new t(tokenData.hash.substr(34,32));for(let t=0;t<1e6;t+=2)this.prngA(),this.prngB()}rd(){return this.useA=!this.useA,this.useA?this.prngA():this.prngB()}rn(t,e){return t+(e-t)*this.rd()}rb(t=.5){return this.rd()<t}ri(t,e){return Math.floor(this.rn(t,e+1))}rc(t){return t[this.ri(0,t.length-1)]}}var R=new Random,pUtil=new PU,isAP=!1,isFP=!1,isBDP=!1,dTCP=!1,zP=1,iW=wi.innerWidth,iH=wi.innerHeight,lSig=()=>{console.log(" \n      .-. .  . .-. \n      |-|  )(  | | \n      ' ' '  ' '-' \n \n      by jiwa                                                                                                              \n      \n      ")},lDm=()=>{console.log("\n    thread and spool ready\n    pattern takes its turn with death\n    weave of endless bliss\n    ")},shuf=t=>{for(var e,s,r=t.length;r;)s=Math.floor(R.rd()*r--),e=t[r],t[r]=t[s],t[s]=e;return t},sleep=t=>new pR(e=>{sT(()=>{e()},t)}),gLD=t=>Math.abs(t)%10,seed=()=>19e16*R.rd(),isInt=t=>/^\d+$/.test(t),rD=(t,e)=>Number(ro(t+"e"+e)+"e-"+e),whD=(t=0,e=0,s)=>{const r=t=>t*(iW/zP/1200),n=t=>t*(iH/zP/1200);return s?{w:ro(r(t)),h:ro(n(e)),b:ro((r(t)+n(e))/2)}:{w:r(t),h:n(e),b:(r(t)+n(e))/2}},capP=()=>{try{const r=new URLSearchParams(wi.location.search);var t=r.get("hash")||wi.location.hash.replace("#",""),e=(t=decodeURIComponent(t)).split("|")[0];e&&(tokenData.hash=e);var s=r.get("w")||r.get("W");s&&(iAL=JSON.parse(s)),zP=(zP=r.get("z")||r.get("Z"))?pF(zP)>0&&pF(zP)<71?pF(zP):1:2400==iW&&2400==iH?2:1,(isAP=r.get("a")||r.get("A"))&&(isAP="true"==tLC(isAP)||"1"==isAP),(isBDP=r.get("p")||r.get("P"))&&(isBDP="true"==tLC(isBDP)||"1"==isBDP),(dTCP=r.get("d")||r.get("D"))&&(dTCP="true"==tLC(dTCP)||"1"==dTCP),(isFP=r.get("f")||r.get("F"))&&(isFP="true"==tLC(isFP)||"1"==isFP),(rIP=r.get("r")||r.get("R"))&&(rIP=pI(rIP)),(sRP=r.get("x")||r.get("X"))&&(sRP=pI(sRP))}catch(t){console.log("axo - check qs params : "+t.message)}},tLC=t=>t.toLowerCase();Number.prototype.map=((t,e,s,r)=>(this-t)*(r-s)/(e-t)+s),ro=Math.round,lSig(),lDm(),capP(); var canvas,nC,aClrs,bgAl,fIC1,fIC2,ruINT,ccW,ccH,cSel,xMF,adW,bOLI,bst,bstVal,layout,rL,isM,hA,maxPL,isL,mLV,aRlt,tSp,eithOr,pCor,cT,ofSd,mFIId,ro,identity,iInt,frC=0,mC={a:{items:0},m:[]},eGFX=null,iGFX=null,sGFX=null,nvGFX=null,nvGFXD=null,eGFXD=null,eImgD=null,iGFXD=null,iImgD=null,gUtil=null,sC=!1,cW=0,cH=0,isA=!1,isAM=!1,isC=!1,isCM=!1,isFr=!1,isFM=!1,repInt=null,sR=-1,fEF=4,dBD=40,dMS=255,isBD=!1,isLand=!1,oW=0,odC=[],aL=[],iAL=[],dTC=!1,hNV=!0,ae="axoStateChange",setup=async()=>{await hSS(),beReborn(),wi.addEventListener("resize",()=>{var e=ro(iW/zP),a=ro(iH/zP);e<=cW&&a<=cH?(ccW=e,ccH=a,oW=getOW()):location.reload()})},setState=()=>new pR((e,a)=>{cT=R.rb(.3)?1:R.ri(2,5),isL=R.rb(),adW=R.rb(),hA=R.rb(.3),isM=R.rb(.3),bgAl=R.ri(180,240),cSel=rD(R.rd(),4),aClrs=getAura(),tSp=rD(R.rn(.007,.01),4),ruINT=R.ri(2e4,3e5),mLV=rD(R.rn(.5,30),2),ofSd=R.rb()?1:0,eithOr=R.rb();var r=R.rd();nC="dendritic"==(layout=r<.1?"axonic":r<.4?"somatic":"dendritic")?R.ri(6,32):-1,rL=R.ri(0,4),aRlt=R.rb(.3),bOLI=R.rb(.6)?R.rn(.2,.6):0,bst=R.rb()?R.rn(.3,.7):0,bstVal=R.rn(0,1.4);var i=R.rd();maxPL=i<.4?R.ri(80,140):i<.8||!isL?R.ri(140,200):R.ri(200,360),xMF=.4,isL&&(xMF=rD(R.rn(.3,.6),2)),pCor=R.rb(.25)?rD(R.rn(.2,.4),2):0,capP(),isAP&&(isA=isAP),isBDP&&(isBD=isBDP),isFP&&(isFr=isFP),dTCP&&(dTC=dTCP),null!=sRP&&(sR=sRP),rIP&&(repInt=rIP),e()}),creGfx=(e,a)=>{let r=document.createElement("canvas");return r.width=e,r.height=a,[r,r.getContext("2d",{willReadFrequently:!0})]},beReborn=async()=>{canvas=creGfx(cW,cH),document.body.prepend(canvas[0]),canvas[1].globalAlpha=1,eGFX=creGfx(cW,cH)[1],iGFX=creGfx(cW,cH)[1],sGFX=creGfx(cW,cH)[1],nvGFX=creGfx(cW,cH)[1],await setState(),mC.a=new Itbl(iGFX),await mC.a.setup(),mC.T=new CND,mC.T.init(),mC.T.setup(),setRtn(),setFO(),document.head.innerHTML+="<style> canvas{image-rendering: optimizeSpeed; image-rendering: -moz-crisp-edges;image-rendering: -webkit-optimize-contrast; image-rendering: -o-crisp-edges; image-rendering: pixelated; -ms-interpolation-mode: nearest-neighbor; }</style>";var e=document.documentElement.style,a=document.body.style;e.height="100%",e.overflow="hidden",e.background="rgb(0,0,0)",a.height="100%",a.overflow="hidden",canvas[0].style.margin="0",zAx(zP),wi.addEventListener("message",e=>{var a=tokenData.tokenId;if("object"==typeof e.data&&(e.data.event===ae&&e.data.tokenId!=a&&hE(e.data.action,e.data.value,"api"),"hello"===e.data.event)){if(!e.data.value)return console.error("Give me a name! : "+a);identity=e.data.value,pM("axoReady","hi",identity,"api")}},!1),sC=!0},setRtn=()=>{sI(()=>{dTC||(pM(ae,"c",isC=isCM?isC:!isC),sT(()=>{dTC||pM(ae,"c",isC=isCM?isC:!isC)},16e3))},ruINT)},setFO=()=>{sI(()=>{dTC||(pM(ae,"f",isFr=isFM?isFr:!isFr),sT(()=>{dTC||pM(ae,"f",isFr=isFM?isFr:!isFr)},5e3))},ro(.6*ruINT))},looping=!0,draw=async()=>{sC&&(iInt&&clearInterval(iInt),iAL.forEach(e=>{e.frame===frC&&hE(e.action,e.value,"qs")}),isE||(sGFX.fillStyle=`rgba(0, 0, 0, ${canvas[1].globalAlpha})`,sGFX.fillRect(0,0,cW,cH)),eGFX.clearRect(0,0,cW,cH),eImgD=eGFX.getImageData(0,0,cW,cH),eGFXD=eImgD.data,mC.T.develop(),eGFX.putImageData(eImgD,0,0),sGFX.drawImage(eGFX.canvas,0,0,cW,cH),canvas[1].drawImage(sGFX.canvas,0,0,cW,cH),frC++,looping&&requestAnimationFrame(draw))},run=()=>{setup(),iInt=sI(()=>{draw()},50)};wi.addEventListener("load",run);var hSS=()=>new pR((e,a)=>{zP=zP||1,cW=ccW=ro(iW/zP),cH=ccH=ro(iH/zP),isLand=cW>cH,oW=getOW(),e()}),getOW=()=>{var e=Math.ceil(isLand?cW/100:cH/100);return ro(cW<100||cH<100?1:ro(e>12?12:e<6?6:e))};wi.addEventListener("keyup",e=>{hE(e.key)});var zAx=e=>{1!==e&&document.querySelectorAll("canvas").forEach(a=>{a.style.transform="scale("+e+")",a.style.transformOrigin="top left"})},pM=(e,a,r,i="auto")=>{wi.parent.postMessage({event:e,handle:identity,action:a,value:r,caller:i,tokenId:tokenData.tokenId,id:Date.now()},"*")},hE=(e,a=null,r="user")=>{var i;if(wi.URLSearchParams&&(i=new URLSearchParams(wi.location.search)),pM(ae,e,a,r),i){if("z"===e||"Z"===e){var t=i.get("z"),s=pF(t);t?s>70||s<=0?i.set("z",1):s>.1&&i.set("z",rD(s+.2,2)):i.set("z",1.2),wi.location.search=i.toString()}"x"!==e&&"X"!==e||(t=i.get("z"),s=pF(t),t?s>.1&&i.set("z",rD(s-.1,2)):i.set("z","0.9"),wi.location.search=i.toString()),"w"!==e&&"W"!==e||aL.length>0&&(i.set("w",JSON.stringify(aL)),wi.location.search=i.toString())}"c"!==e&&"C"!==e||lA("C",isC=isCM=a||!isC),"d"!==e&&"D"!==e||lA("D",dTC=a||!dTC),"a"!==e&&"A"!==e||(lA("A",isA=isAM=a||!isA),mC.m.forEach(e=>{e.setA(isA,!0)})),"p"!==e&&"P"!==e||(lA("P",isBD=a||!isBD),canvas[1].globalAlpha=rD(isBD?dBD/255:dMS/255,2)),"f"!==e&&"F"!==e||(lA("F",isFr=isFM=a||!isFr),isFr?mFIId=sI(()=>{mC.m.forEach(e=>{e.reprogram(.5)})},2e3):clearInterval(mFIId)),"s"!==e&&"S"!==e||exportHR(),(isInt(e)||"0"==e)&&(lA(e,e),sR=pI(e))},isE=!1,exportHR=()=>{isE=!0;let e=(new Date).getTime(),a=document.createElement("a");a.download="axo_by_jiwa_"+e.toString()+".png",a.href=sGFX.canvas.toDataURL(),a.click(),isE=!1,sGFX=creGfx(cW,cH)[1],draw()},lA=(e,a)=>{aL.push({action:e,value:a,frame:frC})}; 